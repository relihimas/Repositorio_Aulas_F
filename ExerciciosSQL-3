--1

SELECT      U.CD_GERENTE,
            F.NM_FUNC,
            COUNT(U.NM_FUNC)
FROM        LOC_FUNCIONARIO U
INNER JOIN  LOC_FUNCIONARIO F
ON          U.CD_GERENTE = F.CD_FUNC
WHERE       U.VL_SALARIO < 10000
GROUP BY    U.CD_GERENTE, F.NM_FUNC
ORDER BY    CD_GERENTE ASC;

--2

SELECT      U.CD_GERENTE,
            F.NM_FUNC,
            COUNT(U.NM_FUNC)
FROM        LOC_FUNCIONARIO U
INNER JOIN  LOC_FUNCIONARIO F
ON          U.CD_GERENTE = F.CD_FUNC
WHERE       U.VL_SALARIO < 10000
GROUP BY    U.CD_GERENTE, F.NM_FUNC
HAVING      COUNT(U.NM_FUNC) < 4
ORDER BY    CD_GERENTE ASC;

--3

SELECT      E.CD_ESTADO,
            E.NM_ESTADO,
            COUNT(C.NM_CIDADE)
FROM        LOC_ESTADO E
INNER JOIN  LOC_CIDADE C
ON          E.CD_ESTADO = C.CD_ESTADO
GROUP BY    E.CD_ESTADO, E.NM_ESTADO;

--4

SELECT      F.NR_ESTRELAS,
            SUM(F.VL_SALARIO)
FROM        LOC_FUNCIONARIO F
GROUP BY    F.NR_ESTRELAS
HAVING      SUM(F.VL_SALARIO) > 20000
ORDER BY    F.NR_ESTRELAS ASC;

--5

SELECT      F.NR_ESTRELAS,
            SUM(F.VL_SALARIO)
FROM        LOC_FUNCIONARIO F
WHERE       F.VL_SALARIO <= 7000
GROUP BY    F.NR_ESTRELAS
HAVING      SUM(F.VL_SALARIO) > 20000
ORDER BY    F.NR_ESTRELAS ASC;





